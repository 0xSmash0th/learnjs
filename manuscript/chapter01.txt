# Chapter 1

## Make a simple game

Let's build a game, everybody. Let's have some fun.

Our game will be built from scratch.

We'll create a bunch of objects and functions. We'll put them together to make our game run, and experiment with changing the functions and the object attributes to alter the behavior of the game.

It'll be a single player game. A [roguelike](http://en.wikipedia.org/wiki/Roguelike) [rpg](http://en.wikipedia.org/wiki/Role-playing_video_game) with extremely simple graphics.

Usually roguelike games have procedurally generated levels, but we'll just build static levels for this example.

Our game will feature monsters, weapons, coins, potions, and a hero.

That small list above gives us a good sense of what objects and functions we'll need in our code.

We'll need to represent each of those things in our game code, so let's briefly outline the parts of the game we'll need to build, along with the typical actions each part will have:

### Game
- Loop
- Draw

### Level
- Load level data
- Draw

### Hero
- Update
- Draw
- Drink Potion
- Pick up Coin
- Fight Monster

### Monster
- Update
- Draw
- Fight Hero

### Weapon
- Update
- Draw

### Coin
- Update
- Draw

### Potions
- Update
- Draw

Each of the above headers will be an object in our game, and each of the list items will be methods or attributes of their respective headers.

## Requirements:
You'll need these things installed on your computer:
- node.js
- browserify and beefy

Make sure you're read the intro to node and intro to browserify chapters before starting this project. (TODO: link to those chapters.)

To get started, create a folder for your game. I'm calling it `node-rogue`:

~~~~~~~~
mkdir node-rogue
cd node-rogue
~~~~~~~~

Run the npm init command to create a package.json file for your project:

~~~~~~~~
npm init
~~~~~~~~

Answer all the questions however you want. I kept them mostly at the defaults (text in parentheses is the default, if you just hit enter it'll use that default value).

~~~~~~~~
name: (node-rogue) 
version: (0.0.0) 
description: a roguelike game made with javascript
entry point: (index.js) game.js
test command: node test.js
git repository: git://github.com/learn-js/node-rogue
keywords: gamezzz
author: seth vincent
license: (BSD) MIT

You should end up with a package.json file that looks like this:

~~~~~~~~
{
  "name": "node-rogue",
  "version": "0.0.0",
  "description": "a roguelike game made with javascript",
  "main": "game.js",
  "scripts": {
    "test": "node test.js"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/learnjs/node-rogue"
  },
  "keywords": [
    "gamezzz"
  ],
  "author": "sethvincent",
  "license": "MIT",
  "bugs": {
    "url": "https://github.com/learnjs/node-rogue/issues"
  }
}
~~~~~~~~

Now, create the game.js and test.js files:

~~~~~~~~
touch game.js test.js
~~~~~~~~

We'll also need an index.html file:

~~~~~~~~
touch index.html
~~~~~~~~

Open up that file and make it look like this:

~~~~~~~~
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>node-rogue</title>
</head>
<body>

<h1 id="title">node-rogue</h1>

<canvas id="game"></canvas>

<script src="./bundle.js"></script>
</body>
</html>
~~~~~~~~

Let's add a css file:

~~~~~~~~
touch style.css
~~~~~~~~

And give it some very basic styles:

~~~~~~~~
html,
body {
  font: 16px/1.2 "Helvetica Neue", Helvetica, arial, sans-serif;
  color: #444;
  -webkit-font-smoothing: antialiased;
  font-smoothing: antialiased;
  font-weight: 300;
}

h1#title {
  margin-bottom: 50px;
}

canvas#game {
  display: block;
  margin: 0px auto;
}
~~~~~~~~

To ease development, we'll use a simple game library I recently called `crtrdg-gameloop`. All it does is initialize the canvas, and provide a simple api that emits `update` and `draw` events that we can use to make our game. Later we'll take a look at the crtrdg-gameloop module in detail. (TODO: add a link to that chapter)

Install `crtrdg-gameloop` using npm:

~~~~~~~~
npm install crtrdg-gameloop --save
~~~~~~~~

The `--save` option edits the package.json file and adds the module you're installing the the dependencies list. 

## Now, to start writing javascript! 
Open the game.js file, and get started:

~~~~~~~~
// require crtrdg-gameloop
var Game = require('crtrdg-gameloop');

// create a new game
var game = new Game({
  canvasId: 'game',
  width: 800,
  height: 400,
  backgroundColor: '#ff1f1f'
});

// this runs each time the game loops
// it is useful for things like checking for user input
// moving the position of characters/items
// checking for game boundaries and collision detection
// and other similar tasks
// interval is the time since the last loop
game.on('update', function(interval){
  console.log('update', interval);
});

// the draw event runs after the update event
// it's used for actually drawing your characters / items / backgrounds to the canvas
// context is the actual canvas context, so you'll
// use it to draw just like in the Introduction to Canvas chapter.
game.on('draw', function(context){
  console.log('draw', context);
  context.fillStyle = '#fff';
  context.fillRect(10, 10, 10, 10);
});

// if game.pause() is called somewhere in your code,
// a `pause` event will be emitted
// listen for it like this:
game.on('pause', function(){
  console.log('paused');
});

// if game.resume() is called somewhere in your code,
// a `resume` event will be emitted
// listen for it like this:
game.on('resume', function(){
  console.log('resumed');
});
~~~~~~~~

To run this code we will use beefy.

Open the package.json file and add a `start` script to the scripts object so it looks like this:

~~~~~~~~
"scripts": {
  "test": "node test.js",
  "start": "beefy game.js:bundle.js --live"
},
~~~~~~~~

If you've installed browserify and beefy like this:

~~~~~~~~
npm install -g browserify beefy
~~~~~~~~

You can now run:

~~~~~~~~
npm start
~~~~~~~~

This will serve your index.html file at http://localhost:9966.

Open Chrome, navigate to that url, and open the javascript console.

You should see the `update` and `draw` messages being logged to the console and a big red canvas with a small white block in the top left corner!

This is the beginning of node-rogue.


> _This section of the book is still a work in progress. Make suggestions at [github.com/learn-js/learnjs/issues](http://github.com/learn-js/learnjs/issues).